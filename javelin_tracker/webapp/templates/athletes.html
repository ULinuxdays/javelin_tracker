{% extends "app_base.html" %}

{% block content %}
<section class="panel">
  <header class="panel-header">
    <div>
      <h3>Athletes</h3>
      <p class="muted">Roster control, vitals, and strength standards for ThrowAI.</p>
    </div>
  </header>
  {% if dashboard_onboarding and dashboard_onboarding.demo_data_active %}
  <div class="panel-note muted small">Demo athletes are shown for preview. They will disappear after you add your own athletes.</div>
  {% endif %}
  <div class="split-grid athletes-layout">
    <div class="subpanel">
      <header class="panel-header">
        <div>
          <h4>Roster</h4>
          <p class="muted">Select an athlete to edit their profile.</p>
        </div>
        <div class="filter-bar">
          <input type="search" class="input" placeholder="Search roster" />
          <select class="input" id="athleteTeamFilter" data-team-filter>
            <option value="all">All teams</option>
          </select>
        </div>
      </header>
      <div class="table-wrapper">
        <table class="data-table" id="athletesTable">
          <thead>
            <tr>
              <th>Name</th>
              <th>Team</th>
              <th>Height (cm)</th>
              <th>Weight (kg)</th>
              <th>BMI</th>
              <th>Bench 1RM</th>
              <th>Squat 1RM</th>
            </tr>
          </thead>
          <tbody id="athletesTableBody">
            <tr><td colspan="7">
              <div class="panel-note">
                <p class="section-label">No athletes yet</p>
                <p class="muted small">Add your first athlete to start logging sessions.</p>
                <a class="btn btn-soft" href="#athleteForm">Add athlete</a>
              </div>
            </td></tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="subpanel">
      <header class="panel-header">
        <div>
          <h4>Profile details</h4>
          <p class="muted">Vitals and benchmarks feed daily plans and readiness.</p>
        </div>
      </header>
      <form id="athleteForm" class="stack-form">
        <input type="hidden" name="id" id="athleteId" />
        <div class="form-grid">
          <label class="full">
            <span>Athlete</span>
            <select id="athleteSelect">
              <option value="">Select athlete</option>
            </select>
            <p class="field-error" data-error-for="athleteSelect"></p>
          </label>
          <label>
            <span>Team</span>
            <select id="athleteTeam" name="team_id" data-team-select>
              <option value="">Unassigned</option>
            </select>
          </label>
          <label>
            <span>Height (cm)</span>
            <input type="number" step="0.5" id="athleteHeight" name="height_cm" />
            <p class="field-error" data-error-for="height_cm"></p>
          </label>
          <label>
            <span>Weight (kg)</span>
            <input type="number" step="0.5" id="athleteWeight" name="weight_kg" />
          </label>
          <label>
            <span>BMI</span>
            <input type="text" id="athleteBmi" name="bmi" readonly />
          </label>
          <label>
            <span>Bench 1RM (kg)</span>
            <input type="number" step="0.5" id="athleteBench" name="bench_1rm_kg" />
          </label>
          <label>
            <span>Squat 1RM (kg)</span>
            <input type="number" step="0.5" id="athleteSquat" name="squat_1rm_kg" />
          </label>
          <label class="full">
            <span>Notes</span>
            <textarea id="athleteNotes" name="notes" rows="2" placeholder="Context for standards, injuries, etc."></textarea>
          </label>
        </div>
        <div class="form-actions">
          <button type="submit" class="btn btn-primary">Save changes</button>
        </div>
      </form>
    </div>
    <div class="subpanel">
      <header class="panel-header">
        <div>
          <h4>Create team</h4>
          <p class="muted small">Head coaches can add program teams (e.g., Menâ€™s Javelin).</p>
        </div>
      </header>
      {% if g.user.role == 'head_coach' %}
      <form id="teamForm" class="stack-form">
        <label>
          <span>Team name</span>
          <input type="text" name="name" placeholder="Men's Javelin" required />
        </label>
        <div class="form-actions">
          <button type="submit" class="btn btn-primary">Create team</button>
        </div>
      </form>
      {% else %}
      <div class="panel-note muted small">Team management available to head coaches only.</div>
      {% endif %}
    </div>
  </div>
</section>

<section class="panel">
  <header class="panel-header">
    <div>
      <h3>Import roster (CSV)</h3>
      <p class="muted small">Head coach only. Columns: first_name, last_name, team_name, height_cm, weight_kg.</p>
    </div>
  </header>
  {% if g.user.role == 'head_coach' %}
    <form class="stack-form" id="rosterImportForm">
      <label class="full">
        <span>Upload CSV</span>
        <input type="file" name="file" accept=".csv" />
      </label>
      <div class="form-actions">
        <button type="submit" class="btn btn-primary">Import roster</button>
        <p class="muted small" id="rosterImportStatus">Awaiting file</p>
      </div>
    </form>
  {% else %}
    <div class="panel-note muted small">Roster imports available to head coaches only.</div>
  {% endif %}
</section>
{% endblock %}
